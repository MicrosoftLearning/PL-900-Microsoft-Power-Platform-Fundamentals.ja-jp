---
lab:
  title: ラボ 4:自動化ソリューションの構築方法
  module: 'Module 4: Get Started with Power Automate'
ms.openlocfilehash: 9b07c81fad82867bb54c2889687075fa7a463b81
ms.sourcegitcommit: 36c8fda9cdc6f448416d7000e38c1606bea87d2e
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2022
ms.locfileid: "144812948"
---
# <a name="module-4-get-started-with-power-automate"></a>モジュール 4: Power Automate を使い始める
## <a name="lab-how-to-build-an-automated-solution"></a>ラボ:自動化ソリューションの構築方法

## <a name="scenario"></a>シナリオ

ベローズ カレッジは、キャンパス内に複数の建物を持つ教育機関です。 キャンパスの訪問者は現在、紙の日誌に記録されています。 その情報は一貫して把握されておらず、キャンパス全体の訪問に関するデータを収集して分析する手段もありません。

キャンパスの管理者は、建物へのアクセスがセキュリティ担当者によって管理され、すべての訪問者がホストによって事前に登録され、記録されることが要求される訪問者登録システムを近代化したいと考えています。

このコース全体を通して、アプリケーションを構築するとともに自動化を行って、ベローズ カレッジの管理担当者とセキュリティ担当者がキャンパス内の建物へのアクセスを管理および制御できるようにします。

このラボでは、訪問がスケジュールされたときに訪問者にメールを送信する Power Automate フローを作成します。

# <a name="high-level-lab-steps"></a>ラボ手順の概要

プロジェクトの完了に必要な要件は次のとおりです。

-   訪問がスケジュールされたときに、連絡先にはメールで通知する必要があります。

## <a name="prerequisites"></a>前提条件

-   **モジュール 0 ラボ 0 - ラボ環境の検証** の完了

-   **モジュール 2 ラボ 1 - Common Data Service の概要** の完了

-   個人用メール アドレスを指定して作成した John Doe の連絡先

# <a name="exercise-1-create-visit-notification-flow"></a>演習 \#1:訪問通知フローを作成する

**目的:** この演習では要件を実装する Power Automate フローを作成します。 訪問者には、訪問の作成時に訪問に割り当てられた一意のコードを含むメールが送信されます。

## <a name="task-1-create-a-flow"></a>タスク \#1:フローを作成する

1.  <https://make.powerapps.com> に移動します。 再認証が必要な場合は、**[サインイン]** をクリックし、必要に応じて指示に従ってください。

2.  **[[自分のイニシャル] 練習]** 環境がまだ選択されていない場合は、右上で選択します。

2.  左側のナビゲーションで、 **[フロー]** を選択します。

4.  メッセージが表示されたら、 **[開始する]** を選択します。

5.  **[新しいフロー]** をクリックし、 **[自動クラウド フロー]** を選択します。

6.  **[フロー名]** には「訪問通知」と入力します。

7.  **[フローのトリガーを選択してください]** で、**Dataverse** を検索します。

8.  トリガー **[When a row is added, modified or deleted]\(行が追加、変更、削除されたとき\)** を選択してから、 **[作成]** をクリックします。

9.  フローのトリガー条件を設定します。

    1.  **[変更の種類]** で **[追加済み]** を選択します。

    2.  **[テーブル名]** に **[訪問]** を選択します

    3.  **[範囲]** に **[組織]** を選択します

    4.  トリガー ステップで、省略記号 ( **...** ) をクリックし、 **[名前の変更]** をクリックします。
        このトリガーの名前を「**訪問が追加されたとき**」に変更します。 これは優れた慣習で、あなたや他のフロー編集者が、詳細に踏み込まなくてもステップの目的を理解できるようにするものです。

## <a name="task-2-create-a-step-to-get-the-visitor-row"></a>タスク \#2:訪問者行を取得するステップを作成する

1.  **[新しいステップ]** を選択します。 この手順は、メールを含む訪問者情報を取得するために必要です。

2.  **Dataverse** を検索します。

3.  **[ID で行を取得]** アクションを選択します。

4.  **[テーブル名]** として **[連絡先]** を選択します

5.  **[行 ID]** フィールドを選びます。 ウィンドウがポップアップ表示され、[動的コンテンツ] または [式] を選びます。 

6.  **[行 ID]** フィールドで、動的コンテンツ リストから **[訪問者 (値)]** を選択します。 この手順では、このフローをトリガーするために作成された "訪問" 行の "連絡先" を検索しています。 メール アドレスは "連絡先" テーブルの一部なので、訪問者にメールを送信するためにこの情報が必要になります。 

7.  このアクションで、省略記号 ( **...** ) をクリックし、 **[名前の変更]** をクリックします。
        このアクションの名前を **[訪問者を取得]** に変更します。 これは優れた慣習で、あなたや他のフロー編集者が、詳細に踏み込まなくてもステップの目的を理解できるようにするものです。

## <a name="task-3-create-a-step-to-send-an-email-to-the-visitor"></a>タスク \#3:メールを訪問者に送信するステップを作成する

1.  **[新しい手順]** をクリックします。 これは、訪問者にメールを送信する手順です。

2.  「*メール*」を検索し、**[Office 365 Outlook]** コネクタと **[メールの送信 (V2)]** アクションを選択します。

3.  このアクションを使用するための利用規約に同意するように求められたら、 **[同意する]** をクリックします。

4.  **[宛先]** フィールドの下にある **[動的なコンテンツの追加]** を選択します。 
    
5.  動的コンテンツ リストから **[電子メール]** を選択します。
        > Notice that it is beneath the **Get the visitor** header. This means you
        are selecting the Email that is related to the Visitor that you looked
        up in the previous step.

6.  **[件名]** フィールドに「**Bellows College への訪問予定**」と入力します。

7.  **メール本文** に次のテキストを入力します。

>   動的コンテンツは、フィールドが括弧で囲まれた場所に配置する必要があります。 最初にすべてのテキストをコピーして貼り付けてから、動的コンテンツを正しい場所に追加することをお勧めします。

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   Dear {First Name},

   You are currently scheduled to visit Bellows Campus from {Scheduled Start} until {Scheduled End}.

   Best regards,

   Campus Administration
   Bellows College
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

8.  **{First Name}** テキストを強調表示します。 これを、 **[訪問者の取得]** ステップの **[名]** フィールドに置き換えます。

9.  **{Scheduled Start}** テキストを強調表示します。 これを **訪問が追加されたとき** 手順の **[Scheduled Start]\(スケジュールされた開始\)** フィールドに置き換えます。

10.  **{Scheduled End}** テキストを強調表示します。 これを **訪問が追加されたとき** 手順の **[Scheduled End]\(スケジュールされた終了\)** フィールドに置き換えます。

11.  **[保存]** をクリックします。

次のタスクのために、このフロー タブを開いたままにします。 フローはおおよそ次のようになります。

![フロー ステップの例。](media/4-Flow.png)

## <a name="task-4-validate-and-test-the-flow"></a>タスク \#4:フローを検証して、有効化する

1.  ブラウザーで新しいタブを開き、<https://make.powerapps.com> に移動します。

2.  **[[自分のイニシャル] 練習]** 環境がまだ選択されていない場合は、右上で選択します。

3.  **[アプリ]** をクリックし、前に作成した **[キャンパス管理モデル駆動型]** アプリケーションを選択します。

3.  このブラウザー タブを開いたまま、フローを使用して前のタブに戻ります。

4.  コマンド バーで、**[テスト]** をクリックします。 **[手動]** を選び、 **[テスト]** をクリックします。

5.  モデル駆動型アプリを開いた状態でブラウザー タブに移動します。 

6.  左側のナビゲーションを使用して、 **[訪問者]** を選択します。

6. **[+ 新規]** ボタンを押して、新しい **[訪問者]** レコードを追加します。

7. [訪問者] レコードを次のように入力します。

    -   **名前:** テスト訪問

    -   **訪問者:** John Doe

    -   **開始予定:** 明日の午前 8 時

    -   **終了予定:** 明日の午前 9 時

8. **[保存して閉じる]** ボタンを選択します。

9. フロー テストを実行してブラウザー タブに移動します。 しばらくすると、フローが実行されていることがわかります。 ここで、フロー内の問題をキャッチしたり、問題が正常に実行されたことを確認したりすることができます。 

John Doe のメール アドレスを個人用メール アドレスとして設定しているので、しばらくすると、受信トレイにメールが届きます。 迷惑メール フォルダーに振り分けられる場合があることに注意してください。

# <a name="challenges"></a>課題

-   メールのさまざまな書式を試してみましょう。 どうすればプロ並みの外観になるでしょうか? 
